<Page x:Class="DotBotCarClient.Views.EnrollPage" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Style="{StaticResource TeslaPage}" Title="EnrollPage">
    <!-- ======================================================= DARK COMBOBOX 스타일 (드롭다운 정상 작동 + 색만 변경) ======================================================= -->
    <Page.Resources>
        <!-- 드롭다운 항목 Dark 스타일 -->
        <Style x:Key="DarkComboItem" TargetType="ComboBoxItem">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="#222"/>
            <Setter Property="Height" Value="34"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="ItemBorder" Background="{TemplateBinding Background}">
                            <ContentPresenter Margin="4"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <!-- Hover -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ItemBorder" Property="Background" Value="#333"/>
                            </Trigger>
                            <!-- Selected highlight -->
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="ItemBorder" Property="Background" Value="#2B2B2B"/>
                                <Setter Property="Foreground" Value="{StaticResource TeslaAccent}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- 콤보박스 기본 스타일 -->
        <Style x:Key="DarkComboBox" TargetType="{x:Type ComboBox}">
            <Setter Property="BorderBrush" Value="#444"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="#222"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="SnapsToDevicePixels" Value="true"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton" ClickMode="Press" Focusable="false" IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <Path x:Name="Arrow" Fill="{TemplateBinding Foreground}" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,-150,0" Data="M0,0 L4,4 L8,0 z"/>
                            </ToggleButton>
                            <!-- 선택된 항목을 표시하는 영역 -->
                            <ContentPresenter x:Name="ContentSite" Content="{TemplateBinding SelectionBoxItem}" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" IsHitTestVisible="False" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Margin="{TemplateBinding Padding}" />
                            <!-- 드롭다운 영역 -->
                            <Popup x:Name="PART_Popup" AllowsTransparency="true" IsOpen="{TemplateBinding IsDropDownOpen}"  Placement="Bottom">
                                <Grid MaxHeight="{TemplateBinding MaxDropDownHeight}" MinWidth="{TemplateBinding ActualWidth}">
                                    <!-- **가장 중요한 부분: 드롭다운 배경색 설정** -->
                                    <Border x:Name="DropDownBorder" Background="#222" BorderBrush="#444" BorderThickness="1" CornerRadius="5"/>
                                    <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="true" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                        <StackPanel IsItemsHost="true" KeyboardNavigation.DirectionalNavigation="Contained" />
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <!-- 드롭다운 버튼의 배경 및 테두리 설정 -->
                            <Trigger Property="HasItems" Value="false">
                                <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95"/>
                            </Trigger>
                            <Trigger Property="IsGrouping" Value="true">
                                <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                            </Trigger>
                            <Trigger Property="IsEditable" Value="true">
                                <Setter Property="IsTabStop" Value="false"/>
                                <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden"/>
                            </Trigger>
                            <!-- 포커스 시 테두리 초록색 하이라이트 -->
                            <Trigger Property="IsKeyboardFocusWithin" Value="True">
                                <Setter Property="BorderBrush" Value="{StaticResource TeslaAccent}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>
    <!-- ======================================================= PAGE ROOT ======================================================= -->
    <Grid x:Name="RootGrid">
        <!-- 등장 애니메이션 -->
        <Grid.RenderTransform>
            <TranslateTransform X="40"/>
        </Grid.RenderTransform>
        <Grid.Triggers>
            <EventTrigger RoutedEvent="Loaded">
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.4"/>
                        <DoubleAnimation Storyboard.TargetProperty="(Grid.RenderTransform).(TranslateTransform.X)" From="40" To="0" Duration="0:0:0.4"/>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Grid.Triggers>
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <!-- ======================================================= MAIN CONTAINER ======================================================= -->
        <Border Grid.Column="1" Background="{StaticResource TeslaBox}" CornerRadius="20" Padding="30" Width="400" Effect="{StaticResource TeslaShadow}">
            <StackPanel>
                <!-- Title -->
                <TextBlock Text="회원가입" Style="{StaticResource TeslaTitle}" FontSize="30"/>
                <TextBlock Text="새 계정을 만드세요." Style="{StaticResource TeslaSubText}" Margin="0,0,0,20"/>
                <!-- ID -->
                <TextBlock Text="아이디"/>
                <TextBox x:Name="txtId" Height="40" Padding="10" Background="#222" BorderBrush="#444" Foreground="White" Margin="0,0,0,12"/>
                <!-- NAME -->
                <TextBlock Text="이름"/>
                <TextBox x:Name="txtName" Height="40" Padding="10" Background="#222" BorderBrush="#444" Foreground="White" Margin="0,0,0,12"/>
                <!-- CAR MODEL -->
                <TextBlock Text="자동차 모델 명"/>
                <ComboBox x:Name="cmbCarModel" Style="{StaticResource DarkComboBox}" Height="40" Padding="10" Margin="0,0,0,12" Background="#222" Foreground="White" BorderBrush="#444" BorderThickness="1" FontSize="14" SelectedIndex="0">
                    <ComboBoxItem Content="테슬라" Style="{StaticResource DarkComboItem}"/>
                    <ComboBoxItem Content="폴스타" Style="{StaticResource DarkComboItem}"/>
                </ComboBox>
                <!-- PASSWORD -->
                <TextBlock Text="비밀번호"/>
                <PasswordBox x:Name="pwBox" Height="40" Padding="10" Background="#222" BorderBrush="#444" Foreground="White" Margin="0,0,0,12"/>
                <!-- PASSWORD CONFIRM -->
                <TextBlock Text="비밀번호 확인"/>
                <PasswordBox x:Name="pwConfirmBox" Height="40" Padding="10" Background="#222" BorderBrush="#444" Foreground="White" Margin="0,0,0,20"/>
                <!-- BUTTONS -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button x:Name="BtnEnrollOk" Content="가입 완료" Width="150" Height="42" Margin="0,0,10,0" Click="BtnEnrollOk_Click"/>
                    <Button x:Name="BtnCancel" Content="취소" Width="150" Height="42" Click="BtnCancel_Click"/>
                </StackPanel>
            </StackPanel>
        </Border>
    </Grid>
</Page>